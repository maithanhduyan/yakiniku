# Customer Experience Workflow - Yakiniku.io Platform

## Tá»•ng quan

Trang web khÃ¡ch hÃ ng Ä‘Æ°á»£c thiáº¿t káº¿ **Mobile-First** vá»›i 2 tÃ­nh nÄƒng chÃ­nh:
1. **Booking Widget** - Äáº·t bÃ n theo wizard 6 bÆ°á»›c
2. **Chat Widget** - AI Chat vá»›i customer insights

---

## 1. BOOKING WIDGET WORKFLOW

### 1.1 Äiá»ƒm vÃ o (Entry Points)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ENTRY POINTS                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“± Header "ä»Šã™ãäºˆç´„" button                               â”‚
â”‚  ğŸ“± Hero section "ä»Šã™ãäºˆç´„" CTA                            â”‚
â”‚  ğŸ“± Floating button (hiá»‡n khi scroll qua booking section)   â”‚
â”‚  ğŸ“± Mobile nav "ä»Šã™ãäºˆç´„"                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    [Scroll to #booking section]
```

### 1.2 Flow 6 BÆ°á»›c

```
Step 1          Step 2          Step 3          Step 4          Step 5          Success
â”Œâ”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚æ—¥ä»˜ â”‚â”€â”€â”€â”€â”€â”€â”€â–¶â”‚æ™‚é–“ â”‚â”€â”€â”€â”€â”€â”€â”€â–¶â”‚äººæ•° â”‚â”€â”€â”€â”€â”€â”€â”€â–¶â”‚æƒ…å ± â”‚â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ç¢ºèª â”‚â”€â”€â”€â”€â”€â”€â”€â–¶â”‚å®Œäº† âœ“   â”‚
â”‚     â”‚        â”‚     â”‚        â”‚     â”‚        â”‚     â”‚        â”‚     â”‚        â”‚         â”‚
â”‚ğŸ“…   â”‚        â”‚ğŸ•   â”‚        â”‚ğŸ‘¥   â”‚        â”‚ğŸ“   â”‚        â”‚âœ…   â”‚        â”‚ğŸ‰       â”‚
â””â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚              â”‚              â”‚              â”‚              â”‚
  â”‚              â”‚              â”‚              â”‚              â”‚
  â–¼              â–¼              â–¼              â–¼              â–¼
Calendar      Time Grid      Guest Grid    Form Input    Review &
Picker        Buttons        Buttons       Fields        Submit
```

---

### Step 1: æ—¥ä»˜é¸æŠ (Date Selection)

**UI Components:**
- Month navigation: `â€¹` `2026å¹´ 2æœˆ` `â€º`
- Calendar grid vá»›i Japanese weekday headers: æ—¥ æœˆ ç« æ°´ æœ¨ é‡‘ åœŸ
- Date cells vá»›i tráº¡ng thÃ¡i:
  - `disabled` - NgÃ y quÃ¡ khá»©, ngÃ y nghá»‰ (ç«æ›œæ—¥)
  - `available` - CÃ³ thá»ƒ chá»n (cursor: pointer)
  - `selected` - ÄÃ£ chá»n (gold background)

**User Actions:**
1. Scroll calendar hoáº·c dÃ¹ng `â€¹` `â€º` Ä‘á»ƒ chá»n thÃ¡ng
2. Click/tap vÃ o ngÃ y available
3. NÃºt "æ¬¡ã¸é€²ã‚€" Ä‘Æ°á»£c enable â†’ click Ä‘á»ƒ tiáº¿p

**Technical Flow:**
```javascript
User click date
    â”‚
    â–¼
bookingData.date = selectedDate
    â”‚
    â–¼
API: GET /api/bookings/available-slots?branch_code=JIAN&date=2026-02-05
    â”‚
    â–¼
Cache available time slots for Step 2
    â”‚
    â–¼
Enable "æ¬¡ã¸é€²ã‚€" button
```

---

### Step 2: æ™‚é–“é¸æŠ (Time Selection)

**UI Components:**
- Heading: "ã”æ¥åº—æ™‚é–“ã‚’é¸æŠ" / "Select Time"
- Time slot grid (dynamic tá»« API):
  ```
  [17:00] [17:30] [18:00] [18:30]
  [19:00] [19:30] [20:00] [20:30]
  [21:00] [21:30] [22:00]
  ```
- Tráº¡ng thÃ¡i: `available` / `selected` / `disabled` (náº¿u full)

**User Actions:**
1. Click/tap vÃ o time slot
2. Slot Ä‘Æ°á»£c highlight (gold border + background)
3. Click "æ¬¡ã¸é€²ã‚€" Ä‘á»ƒ tiáº¿p

**Technical Flow:**
```javascript
User click time slot
    â”‚
    â–¼
bookingData.time = "18:00"
    â”‚
    â–¼
Highlight selected slot
    â”‚
    â–¼
Enable "æ¬¡ã¸é€²ã‚€" button
```

---

### Step 3: äººæ•°é¸æŠ (Guest Count)

**UI Components:**
- Heading: "ã”æ¥åº—äººæ•°ã‚’é¸æŠ" / "Number of Guests"
- Guest count buttons:
  ```
  [1åæ§˜] [2åæ§˜] [3åæ§˜] [4åæ§˜]
  [5åæ§˜] [6åæ§˜] [7åæ§˜] [8+åæ§˜]
  ```

**User Actions:**
1. Click/tap sá»‘ ngÆ°á»i
2. Button Ä‘Æ°á»£c highlight
3. Click "æ¬¡ã¸é€²ã‚€" Ä‘á»ƒ tiáº¿p

**Special Case: 8+ ngÆ°á»i**
- Hiá»ƒn thá»‹ note: "8åæ§˜ä»¥ä¸Šã¯ãŠé›»è©±ã§ã”äºˆç´„ãã ã•ã„"
- Hoáº·c input field cho sá»‘ chÃ­nh xÃ¡c

---

### Step 4: ãŠå®¢æ§˜æƒ…å ± (Customer Information)

**UI Components:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãŠåå‰ *                           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ å±±ç”° å¤ªéƒ                       â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                    â”‚
â”‚ é›»è©±ç•ªå· *                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ 090-1234-5678                  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                    â”‚
â”‚ ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ example@email.com              â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                    â”‚
â”‚ ã”è¦æœ›ãƒ»å‚™è€ƒ                       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼ã‚„ç‰¹åˆ¥ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆ     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Validation:**
- Name: Required, non-empty
- Phone: Required, format `^\d{2,4}-?\d{2,4}-?\d{3,4}$`
- Email: Optional, valid email format
- Note: Optional, max 500 chars

**iOS Zoom Prevention:**
- Táº¥t cáº£ input cÃ³ `font-size: 16px` Ä‘á»ƒ trÃ¡nh iOS auto-zoom

---

### Step 5: ç¢ºèª (Confirmation)

**UI Components:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã”äºˆç´„å†…å®¹ã®ç¢ºèª                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã”æ¥åº—æ—¥   â”‚ 2026å¹´2æœˆ5æ—¥ (æœ¨)     â”‚
â”‚ æ™‚é–“       â”‚ 18:00                 â”‚
â”‚ äººæ•°       â”‚ 3åæ§˜                 â”‚
â”‚ ãŠåå‰     â”‚ å±±æœ¬ èŠ±å­             â”‚
â”‚ é›»è©±ç•ªå·   â”‚ 090-1111-2222         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     [äºˆç´„ã‚’ç¢ºå®šã™ã‚‹]  [æˆ»ã‚‹]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**User Actions:**
1. Review thÃ´ng tin
2. Click "äºˆç´„ã‚’ç¢ºå®šã™ã‚‹" Ä‘á»ƒ submit
3. Hoáº·c click "æˆ»ã‚‹" Ä‘á»ƒ quay láº¡i chá»‰nh sá»­a

**Technical Flow:**
```javascript
User click "äºˆç´„ã‚’ç¢ºå®šã™ã‚‹"
    â”‚
    â–¼
Button disabled + "é€ä¿¡ä¸­..."
    â”‚
    â–¼
POST /api/bookings
{
  date: "2026-02-05",
  time: "18:00",
  guests: 3,
  guest_name: "å±±æœ¬ èŠ±å­",
  guest_phone: "090-1111-2222",
  guest_email: "hanako@test.com",
  note: null,
  branch_code: "JIAN"
}
    â”‚
    â–¼
API Response â†’ Success
    â”‚
    â–¼
POST /api/customers/identify (async, khÃ´ng block)
    â”‚
    â–¼
Go to Success Step
    â”‚
    â–¼
ğŸ”” SSE Notification sent to Dashboard
```

---

### Success Step: å®Œäº†

**UI Components:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              âœ“                     â”‚
â”‚                                    â”‚
â”‚    ã”äºˆç´„ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™       â”‚
â”‚                                    â”‚
â”‚    ã”äºˆç´„ã‚’æ‰¿ã‚Šã¾ã—ãŸã€‚             â”‚
â”‚    ç¢ºèªã®ãŠé›»è©±ã‚’ã•ã›ã¦ã„ãŸã ã     â”‚
â”‚    å ´åˆãŒã”ã–ã„ã¾ã™ã€‚               â”‚
â”‚    å½“æ—¥ã®ã”æ¥åº—ã‚’å¿ƒã‚ˆã‚Š             â”‚
â”‚    ãŠå¾…ã¡ã—ã¦ãŠã‚Šã¾ã™ã€‚             â”‚
â”‚                                    â”‚
â”‚       [æ–°ã—ã„äºˆç´„ã‚’ã™ã‚‹]           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Haptic Feedback:**
- `navigator.vibrate([50, 50, 100])` trÃªn mobile

---

## 2. CHAT WIDGET WORKFLOW

### 2.1 Vá»‹ trÃ­ & Trigger

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                     â”‚
â”‚         [Website Content]           â”‚
â”‚                                     â”‚
â”‚                                     â”‚
â”‚                                     â”‚
â”‚                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚                         â”‚ ğŸ’¬ 1  â”‚   â”‚ â† Floating chat button
â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    (bottom-right, fixed)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Badge Number:**
- Hiá»ƒn thá»‹ `1` khi cÃ³ unread message
- áº¨n khi user má»Ÿ chat

---

### 2.2 Chat Window UI

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ’¬ Yakiniku.io                   âœ•  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ã“ã‚“ã«ã¡ã¯ï¼Yakiniku.ioã¸   â”‚    â”‚
â”‚  â”‚ ã‚ˆã†ã“ãã€‚ğŸ¥©                â”‚    â”‚
â”‚  â”‚                       15:30 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                     â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚         â”‚ ãŠã™ã™ã‚ã¯ä½•ã§ã™ã‹ï¼Ÿ â”‚     â”‚
â”‚         â”‚               15:31 â”‚     â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ æœ¬æ—¥ã®ãŠã™ã™ã‚ã¯...         â”‚    â”‚
â”‚  â”‚                       15:31 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ãŠã™ã™ã‚] [äºˆç´„] [å–¶æ¥­æ™‚é–“]        â”‚ â† Quick Actions
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ãŠåå‰ã‚’å…¥åŠ›... [ä¿å­˜]              â”‚ â† Customer Name (optional)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” [é€ä¿¡] â”‚
â”‚ â”‚ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›...      â”‚        â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 2.3 Chat Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CHAT FLOW                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

User opens chat
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Check localStorageâ”‚
â”‚ yakiniku_customer â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚         â”‚
    â–¼         â–¼
[Has Name]  [No Name]
    â”‚         â”‚
    â–¼         â–¼
"ã€‡ã€‡æ§˜ã€    "ã“ã‚“ã«ã¡ã¯ï¼
ã“ã‚“ã«ã¡ã¯ï¼  ãŠåå‰ã‚’æ•™ãˆã¦
"             ãã ã•ã„"
    â”‚         â”‚
    â–¼         â–¼
Check         Wait for
Customer      name input
Insights      â”‚
    â”‚         â–¼
    â–¼      Save to
Show          localStorage
preferences   â”‚
"å‰å›ã¯       â–¼
ä¸Šã‚¿ãƒ³å¡©ã‚’    Greet with
ã”æ³¨æ–‡..."    name
```

---

### 2.4 Message Processing

```
User sends message
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Add to UI        â”‚
â”‚ (outgoing style) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Show typing      â”‚
â”‚ indicator Â·Â·Â·    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /api/chat/  â”‚
â”‚ {                â”‚
â”‚   message,       â”‚
â”‚   customer_name, â”‚
â”‚   history,       â”‚
â”‚   branch_code    â”‚
â”‚ }                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚         â”‚
    â–¼         â–¼
[Success]  [Failed]
    â”‚         â”‚
    â–¼         â–¼
Hide       Fallback
typing     keyword
    â”‚      responses
    â–¼         â”‚
Add AI        â–¼
response   Add fallback
to UI      response
```

---

### 2.5 Fallback Responses (Khi API fail)

| Keyword | Response |
|---------|----------|
| ãŠã™ã™ã‚ | æœ¬æ—¥ã®ãŠã™ã™ã‚ã¯ï¼šğŸ¥‡ ç‰¹é¸é»’æ¯›å’Œç‰›ã‚«ãƒ«ãƒ“... |
| ãƒ¬ãƒåˆºã— | ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“ãŒã€ç¾åœ¨ãƒ¬ãƒåˆºã—ã¯æ³•å¾‹ã«ã‚ˆã‚Š... |
| ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼ | ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼å¯¾å¿œå¯èƒ½ã§ã™ã€‚ã”æ¥åº—æ™‚ã«... |
| è¨˜å¿µæ—¥ | è¨˜å¿µæ—¥ã®ã”äºˆå®šã§ã™ã­ï¼ğŸ‰ ç‰¹åˆ¥ãƒ‡ã‚¶ãƒ¼ãƒˆãƒ—ãƒ¬ãƒ¼ãƒˆ... |
| äºˆç´„ | ã”äºˆç´„ã¯ã“ã®ãƒšãƒ¼ã‚¸ã®ã€Œã”äºˆç´„ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‹ã‚‰... |
| å–¶æ¥­ | å–¶æ¥­æ™‚é–“: 17:00 - 23:00ï¼ˆL.O. 22:30ï¼‰... |
| ãƒ›ãƒ«ãƒ¢ãƒ³ | ãƒ›ãƒ«ãƒ¢ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼šãƒ»ä¸ŠãƒŸãƒ Â¥980... |
| (default) | ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼è©³ã—ãã¯ãŠé›»è©±ã§... |

---

### 2.6 Customer Insights Integration

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CUSTOMER INSIGHTS FLOW                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Customer sends message mentioning preference
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AI extracts        â”‚
â”‚ preferences        â”‚
â”‚ (OpenAI Function)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Save to database   â”‚
â”‚ branch_customers   â”‚
â”‚ preferences JSON   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Next visit:        â”‚
â”‚ "å‰å›ã¯ä¸Šã‚¿ãƒ³å¡©ã‚’   â”‚
â”‚ ã”æ³¨æ–‡ã„ãŸã ãã¾   â”‚
â”‚ ã—ãŸã€‚æœ¬æ—¥ã‚‚       â”‚
â”‚ ã„ã‹ãŒã§ã™ã‹ï¼Ÿ"    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Preference Categories:**
- `food_preferences` - MÃ³n Æ°a thÃ­ch
- `allergies` - Dá»‹ á»©ng
- `seating` - YÃªu cáº§u chá»— ngá»“i
- `occasions` - Dá»‹p Ä‘áº·c biá»‡t

---

## 3. UX OPTIMIZATION TECHNIQUES

### 3.1 Immediate Feedback

```javascript
// âŒ Sai - Äá»£i API xong má»›i hiá»‡n
await fetch('/api/bookings');
showSuccess();

// âœ… ÄÃºng - Feedback ngay
showLoading();  // Immediate
await fetch('/api/bookings');
showSuccess();
```

### 3.2 Typing Indicator

```
User sends message
        â”‚
        â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Â· Â· Â·   â”‚  â† Typing indicator (3 dots animation)
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
     ~1-2s
        â”‚
        â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ AI Response     â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 Touch Optimization

- Touch targets: **48px minimum** (var(--touch-target))
- Prevent double-tap zoom on buttons
- Haptic feedback on success

### 3.4 iOS Safari Fixes

- `font-size: 16px` on all inputs (prevent auto-zoom)
- `viewport-fit=cover` for notch devices
- `-webkit-overflow-scrolling: touch` for smooth scroll

---

## 4. STATE MANAGEMENT

### 4.1 Booking State

```javascript
const bookingData = {
    date: null,      // Date object
    time: null,      // "18:00"
    guests: null,    // 3
    name: '',        // "å±±æœ¬ èŠ±å­"
    phone: '',       // "090-1111-2222"
    email: '',       // "hanako@test.com"
    note: ''         // "å€‹å®¤å¸Œæœ›"
};

let currentStep = 1;  // 1-5 + success
```

### 4.2 Chat State

```javascript
// localStorage keys
'yakiniku_customer'      // Customer name
'yakiniku_chat_history'  // Array of messages (max 50)
'yakiniku_insights'      // Customer preferences

// In-memory
let chatHistory = [];
let currentCustomer = '';
```

---

## 5. ERROR HANDLING

### 5.1 Booking Errors

| Error | User Message |
|-------|--------------|
| API timeout | äºˆç´„ã‚¨ãƒ©ãƒ¼: æ¥ç¶šã§ãã¾ã›ã‚“ã§ã—ãŸ |
| Slot unavailable | ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“ã€ãã®æ™‚é–“ã¯æº€å¸­ã§ã™ |
| Validation fail | ãŠåå‰ã¨é›»è©±ç•ªå·ã¯å¿…é ˆã§ã™ |

### 5.2 Chat Errors

| Error | Behavior |
|-------|----------|
| API fail | Fallback to keyword responses |
| Network error | ãŠé›»è©±ï¼ˆ044-789-8413ï¼‰ã§ãŠå•ã„åˆã‚ã›ãã ã•ã„ |
| Rate limit | Show retry after message |

---

## 6. REAL-TIME NOTIFICATIONS

### 6.1 Flow

```
Customer creates booking
        â”‚
        â–¼
Backend saves to DB
        â”‚
        â–¼
notify_new_booking()
        â”‚
        â–¼
SSE broadcast to Dashboard
        â”‚
        â–¼
Dashboard shows toast
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”” æ–°è¦äºˆç´„         â”‚
â”‚ å±±æœ¬ èŠ±å­æ§˜ 3åæ§˜   â”‚
â”‚ 2026-02-05 18:00    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 Notification Types

| Type | Title | When |
|------|-------|------|
| `new_booking` | ğŸ”” æ–°è¦äºˆç´„ | New booking created |
| `booking_confirmed` | âœ… äºˆç´„ç¢ºèª | Staff confirms |
| `booking_cancelled` | âŒ ã‚­ãƒ£ãƒ³ã‚»ãƒ« | Booking cancelled |
| `vip_arrived` | â­ VIPæ¥åº— | VIP customer arrives |

---

## 7. MOBILE-FIRST DESIGN

### 7.1 Breakpoints

```css
/* Mobile First */
.element { /* Mobile styles */ }

/* Tablet */
@media (min-width: 768px) { }

/* Desktop */
@media (min-width: 1024px) { }
```

### 7.2 Touch Targets

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚                             â”‚     â”‚
â”‚   â”‚      48px minimum height    â”‚     â”‚
â”‚   â”‚                             â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                       â”‚
â”‚   â† 8px padding between buttons â†’     â”‚
â”‚                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8. PERFORMANCE OPTIMIZATIONS

### 8.1 UX Perceived Latency

| Technique | Impact |
|-----------|--------|
| Immediate feedback | â­â­â­â­â­ |
| UI khÃ´ng Ä‘á»£i AI | â­â­â­â­â­ |
| Typing indicator | â­â­â­â­ |
| Optimistic UI | â­â­â­â­ |
| Cache available slots | â­â­â­ |

### 8.2 Technical

- AOS animations: `once: true` (chá»‰ animate 1 láº§n)
- Scroll handlers: `{ passive: true }`
- Chat history: Max 50 messages
- Debounce resize/scroll events

---

## 9. ACCESSIBILITY

- ARIA labels trÃªn buttons
- Keyboard navigation (Enter to submit)
- Focus management khi switch steps
- Color contrast Ä‘áº£m báº£o WCAG 2.1 AA

---

## Summary

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CUSTOMER JOURNEY MAP                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Landing    â†’    Browse    â†’    Decide    â†’    Book      â†’  Confirm
   â”‚              â”‚              â”‚              â”‚             â”‚
   â–¼              â–¼              â–¼              â–¼             â–¼
Hero         Menu &          Chat with      6-Step        Success
Section      Space           AI for         Wizard        + Staff
             Sections        questions                    Notified

             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚     ğŸ’¬ Chat Widget always available     â”‚
             â”‚     for questions at any stage          â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
