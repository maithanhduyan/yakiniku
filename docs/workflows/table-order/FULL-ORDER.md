# Table Order â€” Quy trÃ¬nh tráº£i nghiá»‡m khÃ¡ch hÃ ng

> MÃ´ táº£ chi tiáº¿t tá»«ng bÆ°á»›c khÃ¡ch hÃ ng thao tÃ¡c trÃªn mÃ¡y tÃ­nh báº£ng (iPad) Ä‘áº·t táº¡i bÃ n Äƒn.
> á»¨ng dá»¥ng hoáº¡t Ä‘á»™ng theo vÃ²ng Ä‘á»i 4 pha: **WELCOME â†’ ORDERING â†’ BILL_REVIEW â†’ CLEANING â†’ WELCOME**

---

## Phase 1: WELCOME â€” MÃ n hÃ¬nh chÃ o má»«ng

1. NhÃ¢n viÃªn Ä‘áº·t mÃ¡y tÃ­nh báº£ng táº¡i bÃ n Äƒn, mÃ n hÃ¬nh hiá»ƒn thá»‹ **Welcome Screen**:
   - Logo ğŸ– vÃ  tÃªn nhÃ  hÃ ngã€Œç„¼è‚‰ã‚¸ãƒŠãƒ³ã€
   - Sá»‘ bÃ n (vÃ­ dá»¥: **T5**) vÃ  sá»‘ khÃ¡ch (vÃ­ dá»¥: **4åæ§˜**)
   - Gá»£i Ã½ chuyá»ƒn ngÃ´n ngá»¯: `ğŸŒ English available`
2. KhÃ¡ch hÃ ng cháº¡m nÃºt **ã€Œã‚¿ãƒƒãƒã—ã¦æ³¨æ–‡ã‚’å§‹ã‚ã‚‹ã€** (Touch Ä‘á»ƒ báº¯t Ä‘áº§u Ä‘áº·t mÃ³n).
3. Há»‡ thá»‘ng táº¡o `session_id` má»›i, chuyá»ƒn sang pha **ORDERING**.

---

## Phase 2: ORDERING â€” Duyá»‡t menu & Ä‘áº·t mÃ³n

### 2.1 Giao diá»‡n chÃ­nh

MÃ n hÃ¬nh chia thÃ nh cÃ¡c vÃ¹ng:

| VÃ¹ng | MÃ´ táº£ |
|------|--------|
| **Header** | Logo, sá»‘ bÃ n, sá»‘ khÃ¡ch, cÃ¡c nÃºt: ğŸ”” å‘¼å‡º (gá»i nhÃ¢n viÃªn), ğŸ’³ ä¼šè¨ˆ (yÃªu cáº§u thanh toÃ¡n), ğŸ“‹ å±¥æ­´ (lá»‹ch sá»­), ğŸ›’ giá» hÃ ng |
| **Category Tabs** | Thanh danh má»¥c cuá»™n ngang (è‚‰, ã‚µã‚¤ãƒ‰, ãƒ‰ãƒªãƒ³ã‚¯, ...) |
| **Menu Grid** | LÆ°á»›i hiá»ƒn thá»‹ cÃ¡c mÃ³n Äƒn (hÃ¬nh áº£nh, tÃªn, giÃ¡) |
| **Floating Cart Bar** | Thanh ná»•i á»Ÿ dÆ°á»›i cÃ¹ng: sá»‘ lÆ°á»£ng mÃ³n, tá»•ng tiá»n, nÃºtã€Œæ³¨æ–‡ã¸ â†’ã€|

### 2.2 Chá»n mÃ³n Äƒn

4. KhÃ¡ch hÃ ng cháº¡m **tab danh má»¥c** (vÃ­ dá»¥: è‚‰ â†’ ã‚µã‚¤ãƒ‰ â†’ ãƒ‰ãƒªãƒ³ã‚¯) Ä‘á»ƒ duyá»‡t menu.
5. Cháº¡m vÃ o **hÃ¬nh áº£nh hoáº·c tÃªn mÃ³n** Ä‘á»ƒ má»Ÿ **Item Detail Modal**:
   - HÃ¬nh áº£nh lá»›n, tÃªn mÃ³n, mÃ´ táº£, giÃ¡
   - Bá»™ chá»n sá»‘ lÆ°á»£ng: **âˆ’** / **+** (máº·c Ä‘á»‹nh: 1)
   - Ã” ghi chÃº tÃ¹y chá»n (vÃ­ dá»¥: ã‚ˆãç„¼ãã€ã‚¿ãƒ¬å¤šã‚)
   - NÃºt **ã€Œã‚«ãƒ¼ãƒˆã«è¿½åŠ ã€** (ThÃªm vÃ o giá»)
6. Cháº¡m **ã€Œã‚«ãƒ¼ãƒˆã«è¿½åŠ ã€** â†’ modal Ä‘Ã³ng, hiá»‡n thÃ´ng bÃ¡o **"ã€‡ã€‡ã‚’ã‚«ãƒ¼ãƒˆã«è¿½åŠ ã—ã¾ã—ãŸ"**, badge giá» hÃ ng cáº­p nháº­t.
7. KhÃ¡ch hÃ ng láº·p láº¡i bÆ°á»›c 4-6 Ä‘á»ƒ chá»n thÃªm mÃ³n.

### 2.3 Xem & gá»­i Ä‘Æ¡n hÃ ng

8. Cháº¡m **ğŸ›’ badge** trÃªn header hoáº·c **thanh ná»•iã€Œæ³¨æ–‡ã¸ â†’ã€** â†’ má»Ÿ **Cart Drawer** (trÆ°á»£t tá»« pháº£i):
   - Danh sÃ¡ch cÃ¡c mÃ³n Ä‘Ã£ chá»n (tÃªn, sá»‘ lÆ°á»£ng Ã—, giÃ¡, nÃºt xÃ³a)
   - Tá»•ng tiá»n á»Ÿ cuá»‘i
   - NÃºt **ã€Œæ³¨æ–‡ã‚’ç¢ºå®šã™ã‚‹ã€** (XÃ¡c nháº­n Ä‘áº·t mÃ³n)
9. KhÃ¡ch hÃ ng cÃ³ thá»ƒ:
   - Äiá»u chá»‰nh sá»‘ lÆ°á»£ng (ï¼‹/âˆ’) hoáº·c xÃ³a mÃ³n khá»i giá»
   - ÄÃ³ng giá» hÃ ng Ä‘á»ƒ tiáº¿p tá»¥c chá»n thÃªm
10. Cháº¡m **ã€Œæ³¨æ–‡ã‚’ç¢ºå®šã™ã‚‹ã€** â†’ Ä‘Æ¡n hÃ ng gá»­i Ä‘áº¿n báº¿p (API POST `/api/tableorder/`):
    - Giá» hÃ ng xÃ³a sáº¡ch, thÃ´ng bÃ¡o **"æ³¨æ–‡ã‚’é€ä¿¡ã—ã¾ã—ãŸ"**
    - ÄÆ¡n hÃ ng lÆ°u vÃ o **lá»‹ch sá»­** (`orderHistory`)
    - MÃ¡y tÃ­nh báº£ng báº¿p (Kitchen Display) nháº­n Ä‘Æ¡n hÃ ng qua WebSocket

### 2.4 Theo dÃµi Ä‘Æ¡n hÃ ng

11. Cháº¡m **ğŸ“‹ å±¥æ­´** trÃªn header â†’ má»Ÿ **History Drawer**:
    - Danh sÃ¡ch táº¥t cáº£ mÃ³n Ä‘Ã£ Ä‘áº·t, nhÃ³m theo thá»i gian gá»­i
    - Tráº¡ng thÃ¡i má»—i mÃ³n: â³ (Ä‘ang chá») hoáº·c âœ“ (Ä‘Ã£ giao)
    - Tá»•ng sá»‘ mÃ³n vÃ  tá»•ng tiá»n
12. Khi báº¿p Ä‘Ã¡nh dáº¥u mÃ³n Ä‘Ã£ xong â†’ tráº¡ng thÃ¡i cáº­p nháº­t real-time qua WebSocket.

### 2.5 Gá»i nhÃ¢n viÃªn

13. Cháº¡m **ğŸ”” å‘¼å‡º** â†’ gá»­i yÃªu cáº§u há»— trá»£ Ä‘áº¿n há»‡ thá»‘ng (nhÃ¢n viÃªn nháº­n thÃ´ng bÃ¡o).

### 2.6 Äáº·t thÃªm mÃ³n (láº·p láº¡i)

14. KhÃ¡ch hÃ ng cÃ³ thá»ƒ Ä‘áº·t thÃªm nhiá»u láº§n (bÆ°á»›c 4-10) trong suá»‘t bá»¯a Äƒn.
    - Má»—i láº§n Ä‘áº·t táº¡o má»™t Ä‘Æ¡n hÃ ng riÃªng, táº¥t cáº£ gom vÃ o lá»‹ch sá»­.

---

## Phase 3: BILL_REVIEW â€” Xem hÃ³a Ä‘Æ¡n & yÃªu cáº§u thanh toÃ¡n

### 3.1 Chuyá»ƒn sang BILL_REVIEW

15. Khi dÃ¹ng bá»¯a xong, khÃ¡ch hÃ ng cháº¡m **ğŸ’³ ä¼šè¨ˆ** trÃªn header.
    - Náº¿u Ä‘Ã£ cÃ³ Ä‘Æ¡n hÃ ng â†’ chuyá»ƒn sang mÃ n hÃ¬nh **Bill Review**.
    - Náº¿u chÆ°a Ä‘áº·t mÃ³n nÃ o â†’ chá»‰ gá»­i thÃ´ng bÃ¡o gá»i nhÃ¢n viÃªn.

### 3.2 MÃ n hÃ¬nh Bill Review

16. MÃ n hÃ¬nh hiá»ƒn thá»‹:
    - TiÃªu Ä‘á» **ã€ŒğŸ“‹ ã”æ³¨æ–‡å†…å®¹ã€** (Ná»™i dung Ä‘Æ¡n hÃ ng)
    - Danh sÃ¡ch táº¥t cáº£ mÃ³n Ä‘Ã£ Ä‘áº·t trong session, nhÃ³m theo thá»i gian
    - Tá»•ng sá»‘ mÃ³n vÃ  **tá»•ng tiá»n**
    - Hai nÃºt hÃ nh Ä‘á»™ng náº±m ngang:
      - **ã€Œï¼‹ è¿½åŠ æ³¨æ–‡ã€** â€” quay láº¡i menu Ä‘á»ƒ Ä‘áº·t thÃªm
      - **ã€ŒğŸ’° ãŠä¼šè¨ˆã‚’ãŠé¡˜ã„ã™ã‚‹ã€** â€” yÃªu cáº§u thanh toÃ¡n

### 3.3 ThÃªm mÃ³n (tÃ¹y chá»n)

17. Cháº¡m **ã€Œï¼‹ è¿½åŠ æ³¨æ–‡ã€** â†’ quay láº¡i pha **ORDERING**, tiáº¿p tá»¥c Ä‘áº·t mÃ³n.
    - Sau khi Ä‘áº·t xong, cháº¡m **ğŸ’³ ä¼šè¨ˆ** láº§n ná»¯a Ä‘á»ƒ quay láº¡i Bill Review.

### 3.4 YÃªu cáº§u thanh toÃ¡n

18. Cháº¡m **ã€ŒğŸ’° ãŠä¼šè¨ˆã‚’ãŠé¡˜ã„ã™ã‚‹ã€**:
    - Gá»­i sá»± kiá»‡n `call-staff (bill)` Ä‘áº¿n backend â†’ thÃ´ng bÃ¡o Ä‘áº¿n POS
    - Hai nÃºt áº©n Ä‘i, hiá»ƒn thá»‹ **"ãŠä¼šè¨ˆã‚’æº–å‚™ä¸­ã§ã™..."** (Ä‘ang chuáº©n bá»‹ hÃ³a Ä‘Æ¡n) vá»›i hiá»‡u á»©ng nháº¥p nhÃ¡y
    - NhÃ¢n viÃªn thu ngÃ¢n nháº­n thÃ´ng bÃ¡o trÃªn mÃ¡y POS

---

## Phase 4: CLEANING â€” Káº¿t thÃºc session

19. Sau khi POS xÃ¡c nháº­n thanh toÃ¡n xong â†’ há»‡ thá»‘ng tá»± Ä‘á»™ng chuyá»ƒn sang **Cleaning Screen**:
    - Hiá»ƒn thá»‹ **ã€ŒğŸ™ ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€** (Cáº£m Æ¡n quÃ½ khÃ¡ch)
    - TÃ³m táº¯t session: sá»‘ láº§n Ä‘áº·t, tá»•ng sá»‘ mÃ³n, tá»•ng tiá»n
20. **Chá»‰ nhÃ¢n viÃªn** má»›i cÃ³ thá»ƒ reset bÃ n: nháº¥n giá»¯ nÃºt **ã€Œãƒªã‚»ãƒƒãƒˆã€** trong **3 giÃ¢y**.
    - XÃ³a toÃ n bá»™ dá»¯ liá»‡u session (giá» hÃ ng, lá»‹ch sá»­, session_id)
    - Quay vá» pha **WELCOME**, sáºµn sÃ ng cho khÃ¡ch má»›i.

---

## TÃ­nh nÄƒng bá»• sung

| TÃ­nh nÄƒng | MÃ´ táº£ |
|-----------|--------|
| **Äa ngÃ´n ngá»¯** | Cháº¡m nÃºt `EN` trÃªn header Ä‘á»ƒ chuyá»ƒn English â†” æ—¥æœ¬èª |
| **Offline-capable** | ÄÆ¡n hÃ ng lÆ°u localStorage, tá»± gá»­i láº¡i khi cÃ³ máº¡ng |
| **Crash recovery** | Session phase lÆ°u localStorage, tá»± phá»¥c há»“i khi reload |
| **Inactivity timeout** | 30 phÃºt khÃ´ng thao tÃ¡c â†’ tá»± Ä‘á»™ng chuyá»ƒn BILL_REVIEW |
| **Real-time sync** | WebSocket cáº­p nháº­t tráº¡ng thÃ¡i mÃ³n (Ä‘Ã£ giao) tá»« báº¿p |
| **Thanh káº¿t ná»‘i** | Hiá»ƒn thá»‹ tráº¡ng thÃ¡i online/offline á»Ÿ dÆ°á»›i cÃ¹ng |

---

## SÆ¡ Ä‘á»“ luá»“ng

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    Touch      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    ğŸ’³ ä¼šè¨ˆ     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ WELCOME â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ ORDERING â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ BILL_REVIEW â”‚
â”‚  (chá»)  â”‚               â”‚ (Ä‘áº·t mÃ³n)â”‚â—€â”€â”€â”€ è¿½åŠ æ³¨æ–‡ â”€â”¤ (xem bill)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
     â–²                                                      â”‚
     â”‚               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          ğŸ’° ãŠä¼šè¨ˆ        â”‚
     â””â”€â”€â”€ 3s reset â”€â”€â”‚ CLEANING â”‚â—€â”€â”€â”€â”€â”€â”€ POS confirm â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ (cáº£m Æ¡n) â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
